<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>日本旅行サバイバル - Final Edition</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&display=swap" rel="stylesheet">

<link rel="stylesheet" href="css/directions_game.css">

<link rel="stylesheet" href="css/common_ui.css">
</head>
<body>

<header>
    <a href="#" class="logo"><i class="fa-solid fa-map"></i> 道案内サバイバル</a>
    <a href="#" onclick="showScreen('menu-screen')" class="home-link">メニュー</a>
</header>

<div id="main-container">

    <div id="menu-screen" class="screen active">
        <h2 style="color:#555; margin-bottom:15px;">メニュー</h2>
        <button class="menu-btn" onclick="showScreen('vocab-screen')">
            <span class="menu-icon"><i class="fa-solid fa-book"></i></span>
            <div>1. 言葉のれんしゅう</div>
        </button>
        <button class="menu-btn" onclick="showScreen('ask-screen')">
            <span class="menu-icon"><i class="fa-solid fa-microphone"></i></span>
            <div>2. 質問してみよう</div>
        </button>
        <button class="menu-btn" onclick="showScreen('listen-screen')">
            <span class="menu-icon"><i class="fa-solid fa-ear-listen"></i></span>
            <div>3. 聞いて動こう</div>
        </button>
        <button class="menu-btn" onclick="initGame4()">
            <span class="menu-icon"><i class="fa-solid fa-map-location-dot"></i></span>
            <div>4. 道案内ミッション</div>
        </button>
        <button class="menu-btn" onclick="initGame5()">
            <span class="menu-icon"><i class="fa-solid fa-user-secret"></i></span>
            <div>5. 上級・聞き込み</div>
        </button>
    </div>

    <div id="vocab-screen" class="screen">
        <h3><i class="fa-solid fa-book"></i> 場所・方向・数</h3>
        <div class="vocab-grid" id="vocab-grid"></div>
        <button class="action-btn" style="margin-top:20px; background:#90a4ae;" onclick="showScreen('menu-screen')">戻る</button>
    </div>

    <div id="ask-screen" class="screen">
        <h3><i class="fa-solid fa-microphone"></i> 質問しよう</h3>
        <div class="speech-box">
            <div id="ask-target-icon" style="font-size:2.5em; color:#555;"><i class="fa-solid fa-store"></i></div>
            <div id="ask-target-text" style="font-size:1.2em; font-weight:bold; margin:5px 0;">コンビニ</div>
            <div style="font-size:0.9em; color:#666;">「<b><span id="ask-target-kana">コンビニ</span>は どこですか？</b>」</div>
        </div>
        
        <button id="mic-btn-ask" class="mic-btn" onclick="checkSpeechGame2()"><i class="fa-solid fa-microphone"></i></button>
        <div id="ask-feedback" style="font-weight:bold; height:20px;"></div>
        
        <button class="action-btn" style="margin-top:20px; background:#ff9800;" onclick="setupAskGame()">次の場所へ</button>
        <button class="action-btn" style="margin-top:10px; background:#90a4ae;" onclick="showScreen('menu-screen')">戻る</button>
    </div>

    <div id="listen-screen" class="screen">
        <h3><i class="fa-solid fa-ear-listen"></i> 聞いて動こう</h3>
        <div class="speech-box">
            <button onclick="playRandomCommand()" style="background:var(--accent); border:none; width:60px; height:60px; border-radius:50%; font-size:1.5em; cursor:pointer;"><i class="fa-solid fa-play"></i></button>
            <div style="margin-top:10px; font-weight:bold;">音声を聞いてボタンを押そう</div>
        </div>
        <div id="listen-feedback" style="height:20px; font-weight:bold; color:#d32f2f; margin-bottom:10px;"></div>
        <div class="d-pad">
            <button class="d-btn d-up" onclick="checkListenAnswer('up')"><i class="fa-solid fa-arrow-up"></i></button>
            <button class="d-btn d-left" onclick="checkListenAnswer('left')"><i class="fa-solid fa-arrow-left"></i></button>
            <button class="d-btn d-right" onclick="checkListenAnswer('right')"><i class="fa-solid fa-arrow-right"></i></button>
            <button class="d-btn d-down" onclick="checkListenAnswer('down')"><i class="fa-solid fa-arrow-down"></i></button>
        </div>
        <button class="action-btn" style="margin-top:10px; background:#90a4ae;" onclick="showScreen('menu-screen')">戻る</button>
    </div>

    <div id="game-screen" class="screen">
        <div style="width:100%; display:flex; justify-content:space-between; align-items:center;">
            <div id="game-title" style="font-weight:bold;">Mission</div>
            <button id="replay-nav-btn" onclick="speakNavigation()" style="display:none; background:#ff9800; color:white; border:none; border-radius:20px; padding:5px 15px; font-size:0.9em;"><i class="fa-solid fa-volume-high"></i> 道順を聞く</button>
            <button id="replay-task-btn" onclick="speakTask()" style="display:none; background:#ff9800; color:white; border:none; border-radius:20px; padding:5px 15px; font-size:0.9em;"><i class="fa-solid fa-volume-high"></i> 指示を聞く</button>
        </div>

        <div id="game5-phase1" style="display:none; width:100%; margin-top:10px;">
            <div class="speech-box">
                <div>質問してください：</div>
                <div style="font-weight:bold; font-size:1.1em; margin:5px 0;">「<span id="g5-target-name"></span>は どこですか？」</div>
                <button id="g5-mic-btn" class="mic-btn" style="width:50px; height:50px; font-size:1.2em;" onclick="game5SpeechCheck()"><i class="fa-solid fa-microphone"></i></button>
                <div id="g5-status" style="font-size:0.8em; height:20px; color:#d32f2f;"></div>
            </div>
        </div>

        <div id="map-wrapper">
            <div id="player"><i class="fa-solid fa-person-walking"></i></div>
        </div>

        <div id="map-controls" style="display:none;">
            <div class="d-pad">
                <button class="d-btn d-up" onclick="movePlayer(0, -1)"><i class="fa-solid fa-caret-up"></i></button>
                <button class="d-btn d-left" onclick="movePlayer(-1, 0)"><i class="fa-solid fa-caret-left"></i></button>
                <button class="d-btn d-right" onclick="movePlayer(1, 0)"><i class="fa-solid fa-caret-right"></i></button>
                <button class="d-btn d-down" onclick="movePlayer(0, 1)"><i class="fa-solid fa-caret-down"></i></button>
            </div>
            <button class="action-btn" onclick="checkArrival()">
                <i class="fa-solid fa-location-dot"></i> 着きました！ (Arrived)
            </button>
        </div>

        <button class="action-btn" style="margin-top:10px; background:#90a4ae; font-size:0.9em;" onclick="showScreen('menu-screen')">メニューに戻る</button>
    </div>

</div>

<script src="js/directions_game.js"></script>

<script src="js/common_ui.js"></script>
</body>
</html>