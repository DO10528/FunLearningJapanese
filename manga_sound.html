<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>マンガのオノマトペ - Manga Sound</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&family=Reggae+One&display=swap" rel="stylesheet">

<style>
    /* --- 共通設定 --- */
    :root {
        --primary: #ec407a; /* ポップなピンク */
        --accent: #ffeb3b;
        --bg-color: #fdf2f8;
        --text-color: #333;
        --comic-font: 'Reggae One', cursive; /* マンガっぽいフォント */
        --base-font: 'Zen Maru Gothic', sans-serif;
    }

    *, *::before, *::after { box-sizing: border-box; }

    body {
        font-family: var(--base-font);
        background-color: var(--bg-color);
        color: var(--text-color);
        margin: 0; padding: 0; padding-bottom: 100px;
        min-height: 100vh;
        display: flex; flex-direction: column;
        -webkit-tap-highlight-color: transparent;
        /* マンガっぽい背景パターン */
        background-image: radial-gradient(#ddd 1px, transparent 1px);
        background-size: 20px 20px;
    }

    /* ヘッダー */
    header {
        background: linear-gradient(135deg, #ec407a 0%, #f48fb1 100%);
        color: white; padding: 15px 20px; width: 100%;
        display: flex; justify-content: space-between; align-items: center;
        box-shadow: 0 4px 15px rgba(236, 64, 122, 0.3);
        position: sticky; top: 0; z-index: 100;
    }
    .logo { font-size: 1.2em; font-weight: 900; display: flex; align-items: center; gap: 10px; text-decoration: none; color: white; }
    
    /* 画面コンテナ */
    .screen { display: none; padding: 20px; width: 100%; max-width: 600px; margin: 0 auto; animation: fadeIn 0.4s ease-out; }
    .screen.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* 戻るボタン */
    .btn-back-nav {
        background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.5);
        color: white; padding: 5px 12px; border-radius: 20px; cursor: pointer; font-size: 0.9em; font-weight: bold;
    }

    /* --- 1. 練習リスト (Dictionary) --- */
    .practice-header {
        text-align: center; margin-bottom: 20px; background: white; padding: 15px;
        border-radius: 15px; border: 4px solid #333; box-shadow: 5px 5px 0 #333;
    }
    
    .word-list {
        display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px;
    }

    .word-card {
        background: white; border-radius: 12px; padding: 15px;
        text-align: center; cursor: pointer; position: relative;
        box-shadow: 0 4px 0 #ddd; border: 2px solid #eee;
        transition: transform 0.1s;
    }
    .word-card:active { transform: translateY(3px); box-shadow: 0 1px 0 #ddd; }
    
    .word-jp {
        font-family: var(--comic-font); font-size: 1.4em; color: #333;
        margin-bottom: 5px; word-break: break-all; line-height: 1.1;
    }
    .word-en { font-size: 0.85em; color: #666; font-weight: bold; }
    .play-icon { font-size: 0.8em; color: var(--primary); margin-top: 5px; }

    /* --- 2. レベル選択 --- */
    .level-list { display: flex; flex-direction: column; gap: 15px; }
    .level-card {
        background: white; border-radius: 15px; padding: 20px;
        display: flex; align-items: center; gap: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05); cursor: pointer;
        border-left: 8px solid #ccc; transition: transform 0.1s;
    }
    .level-card:active { transform: scale(0.98); }
    .lvl-icon { font-size: 2em; width: 50px; text-align: center; }
    .lvl-info h3 { margin: 0; font-size: 1.2em; font-family: var(--comic-font); }
    .lvl-info p { margin: 5px 0 0; font-size: 0.85em; color: #777; }

    /* --- 3. ゲーム画面 (Manga Style) --- */
    .manga-panel {
        background: white; border: 4px solid #333; border-radius: 5px;
        height: 250px; position: relative; overflow: hidden;
        display: flex; justify-content: center; align-items: center;
        margin-bottom: 20px; box-shadow: 5px 5px 0 rgba(0,0,0,0.2);
    }
    
    /* 集中線（背景） */
    .focus-lines {
        position: absolute; width: 200%; height: 200%;
        background: repeating-conic-gradient(from 0deg, transparent 0deg 10deg, rgba(236, 64, 122, 0.1) 10deg 20deg);
        animation: spin 20s linear infinite; z-index: 0;
    }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    /* オノマトペ文字 */
    .question-word {
        font-family: var(--comic-font); font-size: 3.5em;
        color: #333; z-index: 10; position: relative;
        text-shadow: 3px 3px 0 #fff, -3px -3px 0 #fff, 3px -3px 0 #fff, -3px 3px 0 #fff, 5px 5px 0 rgba(0,0,0,0.2);
        transform: rotate(-5deg); animation: popWord 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    @keyframes popWord { from { transform: scale(0) rotate(0deg); } to { transform: scale(1) rotate(-5deg); } }

    .speaker-btn {
        position: absolute; bottom: 10px; right: 10px; z-index: 20;
        background: var(--accent); width: 50px; height: 50px; border-radius: 50%;
        border: 3px solid #333; display: flex; justify-content: center; align-items: center;
        font-size: 1.5em; cursor: pointer; box-shadow: 2px 2px 0 #333;
    }
    .speaker-btn:active { transform: translateY(2px); box-shadow: none; }

    /* 選択肢 */
    .choice-container { display: flex; flex-direction: column; gap: 12px; }
    .choice-btn {
        background: white; border: 2px solid #333; padding: 15px;
        border-radius: 50px 20px 30px 40px / 40px 30px 50px 20px; /* 吹き出し風の歪み */
        font-size: 1.2em; font-weight: bold; color: #333;
        cursor: pointer; text-align: center;
        box-shadow: 3px 3px 0 rgba(0,0,0,0.1); transition: transform 0.1s;
    }
    .choice-btn:active { transform: scale(0.98); }
    .choice-btn.correct { background: #c8e6c9; border-color: #2e7d32; color: #2e7d32; }
    .choice-btn.incorrect { background: #ffcdd2; border-color: #c62828; color: #c62828; }

    /* 固定フッター */
    .fixed-footer {
        position: fixed; bottom: 0; left: 0; width: 100%;
        background: white; padding: 15px;
        box-shadow: 0 -4px 15px rgba(0,0,0,0.1); text-align: center; z-index: 200;
    }
    .btn-start {
        background: var(--primary); color: white; border: none;
        padding: 15px 40px; border-radius: 50px; font-weight: 900; font-size: 1.2em;
        width: 100%; max-width: 300px; cursor: pointer; box-shadow: 0 4px 0 #ad1457;
        display: inline-flex; align-items: center; justify-content: center; gap: 10px;
    }
    .btn-start:active { transform: translateY(3px); box-shadow: none; }

    /* 結果画面 */
    .result-score { font-size: 5em; color: var(--primary); font-family: var(--comic-font); margin: 10px 0; }
    .result-msg { font-weight: bold; font-size: 1.2em; }

</style>
</head>
<body>

<header>
    <a href="index.html" class="logo"><i class="fa-solid fa-comment-dots"></i> Manga Sound</a>
    <button class="btn-back-nav" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> もどる</button>
</header>

<div id="screen-practice" class="screen active">
    <div class="practice-header">
        <h2 style="margin:0; font-family:var(--comic-font);">オノマトペ図鑑</h2>
        <p style="margin:5px 0 0; color:#555;">Manga Onomatopoeia List</p>
    </div>

    <div style="margin-bottom:20px; text-align:center;">
        <input type="text" id="search-input" placeholder="Search (e.g., heart, doki...)" 
               style="width:100%; padding:10px; border-radius:20px; border:2px solid #ddd; outline:none;"
               oninput="filterList()">
    </div>

    <div id="dictionary-container" class="word-list"></div>
    <div style="height:80px;"></div>
</div>

<div id="footer-start" class="fixed-footer">
    <button class="btn-start" onclick="showScreen('screen-level')">
        <i class="fa-solid fa-play"></i> GAME START
    </button>
</div>

<div id="screen-level" class="screen">
    <h2 style="text-align:center; margin-bottom:20px;">Level Select</h2>
    <div class="level-list">
        <div class="level-card" style="border-color:#e91e63;" onclick="startGame(1)">
            <div class="lvl-icon" style="color:#e91e63;"><i class="fa-solid fa-heart"></i></div>
            <div class="lvl-info">
                <h3>Level 1: Feelings</h3>
                <p>ドキドキ, ワクワク, ニコニコ...</p>
            </div>
        </div>
        <div class="level-card" style="border-color:#ff9800;" onclick="startGame(2)">
            <div class="lvl-icon" style="color:#ff9800;"><i class="fa-solid fa-person-running"></i></div>
            <div class="lvl-info">
                <h3>Level 2: Actions</h3>
                <p>ゴクゴク, バタバタ, じー...</p>
            </div>
        </div>
        <div class="level-card" style="border-color:#2196f3;" onclick="startGame(3)">
            <div class="lvl-icon" style="color:#2196f3;"><i class="fa-solid fa-music"></i></div>
            <div class="lvl-info">
                <h3>Level 3: Sounds</h3>
                <p>ザーザー, トントン, ガチャン...</p>
            </div>
        </div>
        <div class="level-card" style="border-color:#9c27b0;" onclick="startGame(4)">
            <div class="lvl-icon" style="color:#9c27b0;"><i class="fa-solid fa-bolt"></i></div>
            <div class="lvl-info">
                <h3>Level 4: Manga SFX</h3>
                <p>シーン, ズーン, ドカン...</p>
            </div>
        </div>
    </div>
</div>

<div id="screen-game" class="screen">
    <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-weight:bold;">
        <span>Level <span id="game-lvl">1</span></span>
        <span><span id="q-current">1</span> / 10</span>
    </div>

    <div class="manga-panel">
        <div class="focus-lines"></div>
        <div id="q-word" class="question-word">DOKI</div>
        <button class="speaker-btn" onclick="playQuestionSound()"><i class="fa-solid fa-volume-high"></i></button>
    </div>

    <div style="text-align:center; margin-bottom:15px; font-weight:bold; color:#555;">意味はどれ？ (Which meaning?)</div>

    <div id="choice-container" class="choice-container"></div>
</div>

<div id="screen-result" class="screen" style="text-align:center; padding-top:40px;">
    <h2>RESULT</h2>
    <div class="result-score"><span id="final-score">0</span><span style="font-size:0.4em;">/10</span></div>
    <p id="result-msg" class="result-msg">...</p>
    
    <button class="btn-start" onclick="showScreen('screen-level')">Play Again</button>
    <br><br>
    <button class="btn-back-nav" style="background:#999; border:none; width:100%; max-width:300px; padding:15px;" onclick="showScreen('screen-practice')">
        Back to Dictionary
    </button>
</div>

<script>
    // --- データセット (約100語) ---
    const onomatopoeiaData = {
        1: [ // Feelings & State (25)
            { jp: "ドキドキ", en: "nervous / heart-pounding", kana: "dokidoki" },
            { jp: "ワクワク", en: "excited", kana: "wakuwaku" },
            { jp: "ニコニコ", en: "smiling", kana: "niconico" },
            { jp: "ペコペコ", en: "hungry / bowing", kana: "pekopeko" },
            { jp: "イライラ", en: "annoyed / irritated", kana: "iraira" },
            { jp: "ハラハラ", en: "suspense / nervous", kana: "harahara" },
            { jp: "ニヤニヤ", en: "grinning", kana: "niyaniya" },
            { jp: "プンプン", en: "angry / fuming", kana: "punpun" },
            { jp: "クスクス", en: "giggle / heh heh", kana: "kusukusu" },
            { jp: "しくしく", en: "weeping / sniffle", kana: "shikushiku" },
            { jp: "ガーン", en: "shock", kana: "gaan" },
            { jp: "ズッキューン", en: "heart struck / squee", kana: "zukkyun" },
            { jp: "ムカッ", en: "angry / snap", kana: "muka" },
            { jp: "ギクッ", en: "startled / gulp", kana: "giku" },
            { jp: "ホッ", en: "relieved / phew", kana: "ho" },
            { jp: "がっかり", en: "disappointed", kana: "gakkari" },
            { jp: "びっくり", en: "surprised", kana: "bikkuri" },
            { jp: "すっきり", en: "refreshed", kana: "sukkiri" },
            { jp: "うっかり", en: "carelessly", kana: "ukkari" },
            { jp: "のんびり", en: "relaxed", kana: "nonbiri" },
            { jp: "ぼんやり", en: "spacing out", kana: "bonyari" },
            { jp: "もじもじ", en: "fidgety / shy", kana: "mojimoji" },
            { jp: "メラメラ", en: "flaming (passion/anger)", kana: "meramera" },
            { jp: "ルンルン", en: "happy / humming", kana: "runrun" },
            { jp: "しょんぼり", en: "downhearted", kana: "shonbori" }
        ],
        2: [ // Actions & Body (25)
            { jp: "ゴクゴク", en: "gulping (drink)", kana: "gokugoku" },
            { jp: "モグモグ", en: "chewing", kana: "mogumogu" },
            { jp: "じー", en: "stare", kana: "jii" },
            { jp: "キョロキョロ", en: "look around", kana: "kyorokyoro" },
            { jp: "ジロジロ", en: "stare rudely", kana: "jirojiro" },
            { jp: "スタスタ", en: "brisk walk", kana: "sutasuta" },
            { jp: "ノロノロ", en: "slow / sluggish", kana: "noronoro" },
            { jp: "ウロウロ", en: "loiter / wander", kana: "urouro" },
            { jp: "バタバタ", en: "running around / busy", kana: "batabata" },
            { jp: "なでなで", en: "petting / pat", kana: "nadenade" },
            { jp: "パンパン", en: "pat / clap", kana: "panpan" },
            { jp: "パシッ", en: "catch", kana: "pashi" },
            { jp: "ポイッ", en: "toss", kana: "poi" },
            { jp: "クンクン", en: "sniff", kana: "kunkun" },
            { jp: "ふむふむ", en: "nodding / hmm", kana: "fumufumu" },
            { jp: "ガブッ", en: "bite", kana: "gabu" },
            { jp: "ペロペロ", en: "lick", kana: "peropero" },
            { jp: "グーグー", en: "snoring / stomach growl", kana: "guuguu" },
            { jp: "スイスイ", en: "swimming / smooth", kana: "suisui" },
            { jp: "ゴシゴシ", en: "scrubbing", kana: "goshigoshi" },
            { jp: "グルグル", en: "spinning", kana: "guruguru" },
            { jp: "フラフラ", en: "dizzy / unsteady", kana: "furafura" },
            { jp: "ペラペラ", en: "fluent / chatting", kana: "perapera" },
            { jp: "コソコソ", en: "sneaking / whispering", kana: "kosokoso" },
            { jp: "ギュー", en: "squeeze / hug", kana: "gyuu" }
        ],
        3: [ // Sounds & Nature (25)
            { jp: "ザーザー", en: "heavy rain", kana: "zaazaa" },
            { jp: "ポツポツ", en: "light rain", kana: "potsupotsu" },
            { jp: "ゴロゴロ", en: "thunder / rolling", kana: "gorogoro" },
            { jp: "ヒュー", en: "wind / swish", kana: "hyuu" },
            { jp: "ビューン", en: "zoom (fast)", kana: "byuun" },
            { jp: "キラキラ", en: "sparkle", kana: "kirakira" },
            { jp: "ピカピカ", en: "shiny", kana: "pikapika" },
            { jp: "トントン", en: "knock / tap", kana: "tonton" },
            { jp: "ピンポン", en: "ding dong", kana: "pinpon" },
            { jp: "ガチャ", en: "door opening / click", kana: "gacha" },
            { jp: "カチャカチャ", en: "typing / click clack", kana: "kachakacha" },
            { jp: "ガシャン", en: "crash", kana: "gashan" },
            { jp: "ドカン", en: "boom / explosion", kana: "dokan" },
            { jp: "バタン", en: "slam (door)", kana: "batan" },
            { jp: "ピシャ", en: "splash / splat", kana: "pisha" },
            { jp: "ボチャ", en: "splish / splash", kana: "bocha" },
            { jp: "ふわふわ", en: "fluffy", kana: "fuwafuwa" },
            { jp: "ツルツル", en: "slippery / smooth", kana: "tsurutsuru" },
            { jp: "ネバネバ", en: "sticky", kana: "nebaneba" },
            { jp: "ベタベタ", en: "sticky (unpleasant)", kana: "betabeta" },
            { jp: "サラサラ", en: "silky / dry", kana: "sarasara" },
            { jp: "ワンワン", en: "woof (dog)", kana: "wanwan" },
            { jp: "ニャー", en: "meow (cat)", kana: "nyaa" },
            { jp: "コケコッコー", en: "cock-a-doodle-doo", kana: "kokekokko" },
            { jp: "ゲロゲロ", en: "ribbit (frog)", kana: "gerogero" }
        ],
        4: [ // Manga SFX & Impact (25)
            { jp: "シーン", en: "silence", kana: "shiin" },
            { jp: "ズーン", en: "gloom / doom", kana: "zuun" },
            { jp: "ドクン", en: "heartbeat / badum", kana: "dokun" },
            { jp: "ビクッ", en: "jolt / twitch", kana: "biku" },
            { jp: "パシッ", en: "slap / catch", kana: "pashi" },
            { jp: "ボカッ", en: "hit / punch", kana: "boka" },
            { jp: "ドシン", en: "heavy thud / flump", kana: "doshin" },
            { jp: "ピシッ", en: "crack / flick", kana: "pishi" },
            { jp: "バリッ", en: "rip / tear", kana: "bari" },
            { jp: "ジャジャーン", en: "Ta-da!", kana: "jajaan" },
            { jp: "キラーン", en: "flash / gleam", kana: "kiraan" },
            { jp: "ゴゴゴゴ", en: "menacing rumble", kana: "gogogogo" },
            { jp: "ササッ", en: "rustle / quick move", kana: "sasa" },
            { jp: "ピタッ", en: "stop suddenly", kana: "pita" },
            { jp: "クルクル", en: "spin", kana: "kurukuru" },
            { jp: "ガヤガヤ", en: "noise / crowd", kana: "gayagaya" },
            { jp: "トォー", en: "jump / hup", kana: "too" },
            { jp: "ズッドン", en: "heavy fall / kaboom", kana: "zuddon" },
            { jp: "ポン", en: "pop / pat", kana: "pon" },
            { jp: "くねくね", en: "slither / wiggle", kana: "kunekune" },
            { jp: "めちゃめちゃ", en: "messy / extreme", kana: "mechamecha" },
            { jp: "バラバラ", en: "scattered / crumbling", kana: "barabara" },
            { jp: "ボロボロ", en: "worn out / crumbling", kana: "boroboro" },
            { jp: "ギリギリ", en: "just barely / grinding", kana: "girigiri" },
            { jp: "あちゃ～", en: "oops / yikes", kana: "achaa" }
        ]
    };

    const synth = window.speechSynthesis;
    let voices = [];
    synth.onvoiceschanged = () => { voices = synth.getVoices(); };
    setTimeout(() => { voices = synth.getVoices(); }, 500);

    // --- 状態変数 ---
    let currentLevel = 1;
    let quizList = [];
    let currentQIndex = 0;
    let score = 0;
    let currentItem = null;

    // --- 音声再生 ---
    window.speak = (text) => {
        if (synth.speaking) synth.cancel();
        const utterThis = new SpeechSynthesisUtterance(text);
        utterThis.lang = 'ja-JP';
        utterThis.rate = 1.0;
        const jpVoice = voices.find(v => v.lang.includes('ja') || v.lang.includes('JP'));
        if(jpVoice) utterThis.voice = jpVoice;
        synth.speak(utterThis);
    };

    // --- 画面遷移 ---
    window.showScreen = (id) => {
        document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        
        const footer = document.getElementById('footer-start');
        footer.style.display = (id === 'screen-practice') ? 'block' : 'none';
        window.scrollTo(0,0);
    };

    window.goBack = () => {
        const activeId = document.querySelector('.screen.active').id;
        if (activeId === 'screen-level') showScreen('screen-practice');
        else if (activeId === 'screen-game') {
            if(confirm("ゲームをやめますか？")) showScreen('screen-level');
        }
        else if (activeId === 'screen-result') showScreen('screen-level');
        else window.location.href = 'index.html';
    };

    // --- 辞書生成 ---
    function initDictionary() {
        const container = document.getElementById('dictionary-container');
        container.textContent = '';
        
        // 全データをフラットに
        let allWords = [];
        for(let l=1; l<=4; l++) allWords = allWords.concat(onomatopoeiaData[l]);
        // 名前順ソート (任意)
        // allWords.sort((a,b) => a.kana.localeCompare(b.kana));

        allWords.forEach(item => {
            const card = document.createElement('div');
            card.className = 'word-card';
            card.dataset.kana = item.kana; // 検索用
            card.dataset.en = item.en.toLowerCase();
            
            card.innerHTML = `
                <div class="word-jp">${item.jp}</div>
                <div class="word-en">${item.en}</div>
                <div class="play-icon"><i class="fa-solid fa-volume-high"></i></div>
            `;
            card.onclick = () => speak(item.jp);
            container.appendChild(card);
        });
    }

    // --- 検索機能 ---
    window.filterList = () => {
        const input = document.getElementById('search-input').value.toLowerCase();
        const cards = document.querySelectorAll('.word-card');
        
        cards.forEach(card => {
            const kana = card.dataset.kana;
            const en = card.dataset.en;
            if(kana.includes(input) || en.includes(input)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    };

    // --- ゲームロジック ---
    window.startGame = (level) => {
        currentLevel = level;
        const source = onomatopoeiaData[level];
        // ランダムに10問
        quizList = [];
        for(let i=0; i<10; i++) {
            quizList.push(source[Math.floor(Math.random() * source.length)]);
        }
        currentQIndex = 0;
        score = 0;
        
        document.getElementById('game-lvl').textContent = level;
        showScreen('screen-game');
        nextQuestion();
    };

    function nextQuestion() {
        if(currentQIndex >= 10) {
            endGame();
            return;
        }

        currentItem = quizList[currentQIndex];
        document.getElementById('q-current').textContent = currentQIndex + 1;
        
        const qWordEl = document.getElementById('q-word');
        qWordEl.textContent = currentItem.jp;
        
        // アニメーションリセット
        qWordEl.style.animation = 'none';
        qWordEl.offsetHeight; 
        qWordEl.style.animation = 'popWord 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
        
        // 音声再生
        window.playQuestionSound = () => speak(currentItem.jp);
        setTimeout(() => speak(currentItem.jp), 300);

        // 選択肢生成 (正解1 + 誤答2)
        // 誤答は同レベルから選ぶ
        const source = onomatopoeiaData[currentLevel];
        const others = source.filter(i => i.jp !== currentItem.jp);
        const wrong = others.sort(() => 0.5 - Math.random()).slice(0, 2);
        
        let choices = [currentItem, ...wrong];
        choices.sort(() => 0.5 - Math.random());
        
        const btnContainer = document.getElementById('choice-container');
        btnContainer.textContent = '';
        
        choices.forEach(c => {
            const btn = document.createElement('button');
            btn.className = 'choice-btn';
            btn.textContent = c.en;
            btn.onclick = () => checkAnswer(c.jp === currentItem.jp, btn);
            btnContainer.appendChild(btn);
        });
    }

    function checkAnswer(isCorrect, btn) {
        // ボタン無効化
        const btns = document.querySelectorAll('.choice-btn');
        btns.forEach(b => b.disabled = true);

        if(isCorrect) {
            btn.classList.add('correct');
            score++;
        } else {
            btn.classList.add('incorrect');
            // 正解を表示
            btns.forEach(b => {
                if(b.textContent === currentItem.en) b.classList.add('correct');
            });
        }

        setTimeout(() => {
            currentQIndex++;
            nextQuestion();
        }, 1200);
    }

    function endGame() {
        showScreen('screen-result');
        document.getElementById('final-score').textContent = score;
        const msg = document.getElementById('result-msg');
        
        if(score === 10) msg.textContent = "Excellent! You are a Manga Master!";
        else if(score >= 8) msg.textContent = "Great job! Keep reading manga!";
        else if(score >= 5) msg.textContent = "Good! Try again!";
        else msg.textContent = "Fight! Ganbatte!";
    }

    // 初期化
    initDictionary();

</script>
</body>
</html>