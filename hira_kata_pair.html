<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ã²ã‚‰ã‚«ã‚¿ã‚ã‚ã› - FunLearnJP</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Klee+One:wght@400;600&display=swap" rel="stylesheet">

<style>
    /* --- å…±é€šè¨­å®š --- */
    :root {
        --primary: #00bcd4; /* ã‚·ã‚¢ãƒ³ç³» */
        --accent: #ff4081;
        --bg-color: #e0f7fa;
        --text-color: #333;
        --slot-bg: #ffffff;
    }

    *, *::before, *::after { box-sizing: border-box; }

    body {
        font-family: 'Zen Maru Gothic', sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        margin: 0; padding: 0;
        min-height: 100vh;
        display: flex; flex-direction: column;
        overflow-x: hidden;
        user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠé˜²æ­¢ */
        touch-action: manipulation;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    header {
        background: linear-gradient(135deg, #00bcd4 0%, #0097a7 100%);
        color: white;
        padding: 10px 20px;
        display: flex; justify-content: space-between; align-items: center;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        z-index: 100;
    }
    .logo { font-size: 1.2em; font-weight: 900; color: white; text-decoration: none; display: flex; gap: 10px; align-items: center; }
    .level-badge { background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; font-weight: bold; }

    /* ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ */
    .game-container {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 10px;
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
    }

    /* --- ã‚²ãƒ¼ãƒ ç›¤é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ --- */
    .board {
        display: flex;
        justify-content: space-between;
        width: 100%;
        gap: 5px;
        margin-bottom: 20px;
    }

    /* å·¦å³ã®ãƒ—ãƒ¼ãƒ«ï¼ˆã‚¢ã‚¤ãƒ†ãƒ ç½®ãå ´ï¼‰ */
    .pool-column {
        display: flex;
        flex-direction: column;
        gap: 10px;
        width: 70px; /* ã‚¹ãƒãƒ›å¹…ã«åˆã‚ã›ã¦èª¿æ•´ */
        align-items: center;
        background: rgba(255,255,255,0.5);
        border-radius: 15px;
        padding: 10px 5px;
        min-height: 300px;
    }
    
    .pool-title {
        font-size: 0.9em; font-weight: bold; color: #00838f; margin-bottom: 5px; text-align: center;
    }

    /* ä¸­å¤®ã®ãƒšã‚¢ãƒªãƒ³ã‚°ã‚¨ãƒªã‚¢ */
    .center-area {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding: 0 5px;
        margin-top: 32px; /* ã‚¿ã‚¤ãƒˆãƒ«ã®é«˜ã•åˆ†ãšã‚‰ã™ */
    }

    /* ãƒšã‚¢ã‚’ä½œã‚‹è¡Œ */
    .pair-row {
        display: flex;
        justify-content: center;
        align-items: center;
        background: white;
        border-radius: 15px;
        padding: 5px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        gap: 10px;
        height: 70px;
    }

    .pair-divider {
        color: #ccc; font-size: 1.5em; font-weight: bold;
    }

    /* --- ã‚¢ã‚¤ãƒ†ãƒ ã¨ã‚¹ãƒ­ãƒƒãƒˆ --- */
    .slot {
        width: 60px; height: 60px;
        background: #f5f5f5;
        border: 2px dashed #ccc;
        border-radius: 10px;
        display: flex; justify-content: center; align-items: center;
        transition: background 0.2s;
    }
    .slot.drag-over { background: #b2ebf2; border-color: #00bcd4; border-style: solid; }

    /* ãƒ‰ãƒ©ãƒƒã‚°ã™ã‚‹æ–‡å­—ãƒãƒƒãƒ— */
    .char-chip {
        width: 60px; height: 60px;
        background: white;
        border-radius: 10px;
        border: 2px solid #fff;
        box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        display: flex; justify-content: center; align-items: center;
        font-family: 'Klee One', cursive; /* æ•™ç§‘æ›¸ä½“ */
        font-size: 2rem;
        font-weight: 600;
        color: #333;
        cursor: grab;
        touch-action: none; /* ã‚¹ãƒãƒ›ã§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¹²æ¸‰é˜²æ­¢ */
        z-index: 10;
    }
    
    /* ã²ã‚‰ãŒãªãƒ»ã‚«ã‚¿ã‚«ãƒŠã§è‰²åˆ†ã‘ï¼ˆãƒ’ãƒ³ãƒˆã¨ã—ã¦å°‘ã—ã ã‘ï¼‰ */
    .char-hira { color: #d81b60; border-bottom: 3px solid #f8bbd0; } /* èµ¤ç³» */
    .char-kata { color: #1565c0; border-bottom: 3px solid #bbdefb; } /* é’ç³» */

    .char-chip:active { transform: scale(1.1); cursor: grabbing; z-index: 100; }

    /* ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ã‚´ãƒ¼ã‚¹ãƒˆ */
    .ghost {
        position: fixed; pointer-events: none; z-index: 1000;
        opacity: 0.8; transform: scale(1.1);
    }

    /* --- ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ --- */
    .controls {
        width: 100%; text-align: center; margin-top: auto; padding-bottom: 20px;
    }
    .check-btn {
        background-color: #ff4081;
        color: white;
        border: none;
        padding: 15px 50px;
        border-radius: 50px;
        font-size: 1.4em;
        font-weight: bold;
        box-shadow: 0 6px 0 #c2185b;
        cursor: pointer;
        transition: transform 0.1s;
    }
    .check-btn:active { transform: translateY(4px); box-shadow: 0 2px 0 #c2185b; }

    /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆæ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¸ï¼‰ */
    .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.7);
        display: none; justify-content: center; align-items: center;
        z-index: 2000;
    }
    .modal-content {
        background: white; padding: 30px; border-radius: 20px;
        text-align: center; animation: popIn 0.3s;
    }
    .modal-content h2 { color: #00bcd4; font-size: 2em; margin: 0 0 20px 0; }
    .next-btn {
        background: #00bcd4; color: white; border: none; padding: 10px 30px;
        font-size: 1.2em; border-radius: 10px; cursor: pointer;
    }

    @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

    /* ã‚¹ãƒãƒ›å¾®èª¿æ•´ */
    @media (max-width: 400px) {
        .pool-column { width: 60px; }
        .slot, .char-chip { width: 50px; height: 50px; font-size: 1.6rem; }
        .pair-row { height: 60px; gap: 5px; }
    }
</style>
</head>
<body>

<header>
    <a href="index.html" class="logo"><i class="fa-solid fa-shapes"></i> FunLearnJP</a>
    <div class="level-badge" id="level-indicator">Level 1</div>
</header>

<div class="game-container">
    
    <div class="board">
        <div class="pool-column">
            <div class="pool-title">ã²ã‚‰ãŒãª</div>
            <div id="hira-pool" class="pool-area"></div>
        </div>

        <div class="center-area" id="pair-rows">
            </div>

        <div class="pool-column">
            <div class="pool-title">ã‚«ã‚¿ã‚«ãƒŠ</div>
            <div id="kata-pool" class="pool-area"></div>
        </div>
    </div>

    <div class="controls">
        <button class="check-btn" onclick="checkAnswer()">ã“ãŸãˆã‚ã‚ã›</button>
    </div>
</div>

<div id="success-modal" class="modal-overlay">
    <div class="modal-content">
        <h2>ã›ã„ã‹ã„ï¼ğŸ‰</h2>
        <button class="next-btn" onclick="nextLevel()">ã¤ãã®ãƒ¬ãƒ™ãƒ«ã¸</button>
    </div>
</div>

<audio id="snd-correct" src="assets/sounds/seikai.mp3"></audio>
<audio id="snd-incorrect" src="assets/sounds/bubu.mp3"></audio>

<script>
    // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© (å…¨10ãƒ¬ãƒ™ãƒ«) ---
    const levels = [
        { id: 1, chars: [ {h:'ã‚',k:'ã‚¢'}, {h:'ã„',k:'ã‚¤'}, {h:'ã†',k:'ã‚¦'}, {h:'ãˆ',k:'ã‚¨'}, {h:'ãŠ',k:'ã‚ª'} ] },
        { id: 2, chars: [ {h:'ã‹',k:'ã‚«'}, {h:'ã',k:'ã‚­'}, {h:'ã',k:'ã‚¯'}, {h:'ã‘',k:'ã‚±'}, {h:'ã“',k:'ã‚³'} ] },
        { id: 3, chars: [ {h:'ã•',k:'ã‚µ'}, {h:'ã—',k:'ã‚·'}, {h:'ã™',k:'ã‚¹'}, {h:'ã›',k:'ã‚»'}, {h:'ã',k:'ã‚½'} ] },
        { id: 4, chars: [ {h:'ãŸ',k:'ã‚¿'}, {h:'ã¡',k:'ãƒ'}, {h:'ã¤',k:'ãƒ„'}, {h:'ã¦',k:'ãƒ†'}, {h:'ã¨',k:'ãƒˆ'} ] },
        { id: 5, chars: [ {h:'ãª',k:'ãƒŠ'}, {h:'ã«',k:'ãƒ‹'}, {h:'ã¬',k:'ãƒŒ'}, {h:'ã­',k:'ãƒ'}, {h:'ã®',k:'ãƒ'} ] },
        { id: 6, chars: [ {h:'ã¯',k:'ãƒ'}, {h:'ã²',k:'ãƒ’'}, {h:'ãµ',k:'ãƒ•'}, {h:'ã¸',k:'ãƒ˜'}, {h:'ã»',k:'ãƒ›'} ] },
        { id: 7, chars: [ {h:'ã¾',k:'ãƒ'}, {h:'ã¿',k:'ãƒŸ'}, {h:'ã‚€',k:'ãƒ '}, {h:'ã‚',k:'ãƒ¡'}, {h:'ã‚‚',k:'ãƒ¢'} ] },
        { id: 8, chars: [ {h:'ã‚„',k:'ãƒ¤'}, {h:'ã‚†',k:'ãƒ¦'}, {h:'ã‚ˆ',k:'ãƒ¨'} ] }, // 3æ–‡å­—
        { id: 9, chars: [ {h:'ã‚‰',k:'ãƒ©'}, {h:'ã‚Š',k:'ãƒª'}, {h:'ã‚‹',k:'ãƒ«'}, {h:'ã‚Œ',k:'ãƒ¬'}, {h:'ã‚',k:'ãƒ­'} ] },
        { id: 10, chars: [ {h:'ã‚',k:'ãƒ¯'}, {h:'ã‚’',k:'ãƒ²'}, {h:'ã‚“',k:'ãƒ³'} ] } // 3æ–‡å­—
    ];

    let currentLevelIndex = 0;
    const hiraPool = document.getElementById('hira-pool');
    const kataPool = document.getElementById('kata-pool');
    const pairArea = document.getElementById('pair-rows');
    const levelIndicator = document.getElementById('level-indicator');
    const modal = document.getElementById('success-modal');
    
    const sndCorrect = document.getElementById('snd-correct');
    const sndIncorrect = document.getElementById('snd-incorrect');

    // --- åˆæœŸåŒ– ---
    function initGame() {
        loadLevel(currentLevelIndex);
    }

    function loadLevel(idx) {
        // ãƒªã‚»ãƒƒãƒˆ
        hiraPool.innerHTML = '';
        kataPool.innerHTML = '';
        pairArea.innerHTML = '';
        modal.style.display = 'none';
        
        if (idx >= levels.length) {
            alert("å…¨ãƒ¬ãƒ™ãƒ«ã‚¯ãƒªã‚¢ï¼ãŠã‚ã§ã¨ã†ï¼");
            currentLevelIndex = 0;
            loadLevel(0);
            return;
        }

        const levelData = levels[idx];
        levelIndicator.textContent = `Level ${levelData.id}`;

        // ä¸­å¤®ã®è¡Œã‚’ä½œæˆ (æ–‡å­—æ•°åˆ†)
        levelData.chars.forEach((_, i) => {
            const row = document.createElement('div');
            row.className = 'pair-row';
            // å·¦ã‚¹ãƒ­ãƒƒãƒˆ (ã²ã‚‰ãŒãªç”¨)
            const hSlot = createSlot('hira-slot');
            // åŒºåˆ‡ã‚Š
            const div = document.createElement('div');
            div.className = 'pair-divider';
            div.textContent = '=';
            // å³ã‚¹ãƒ­ãƒƒãƒˆ (ã‚«ã‚¿ã‚«ãƒŠç”¨)
            const kSlot = createSlot('kata-slot');
            
            row.appendChild(hSlot);
            row.appendChild(div);
            row.appendChild(kSlot);
            pairArea.appendChild(row);
        });

        // ãƒãƒƒãƒ—ä½œæˆ (ã‚·ãƒ£ãƒƒãƒ•ãƒ«)
        const hiraChips = [...levelData.chars].sort(() => Math.random() - 0.5);
        const kataChips = [...levelData.chars].sort(() => Math.random() - 0.5);

        // ãƒ—ãƒ¼ãƒ«ã«é…ç½®
        hiraChips.forEach(c => createChip(c.h, 'hira', c.k, hiraPool)); // dataã¨ã—ã¦ãƒšã‚¢ã®ç­”ãˆã‚’æŒãŸã›ã‚‹
        kataChips.forEach(c => createChip(c.k, 'kata', c.h, kataPool));
    }

    function createSlot(type) {
        const slot = document.createElement('div');
        slot.className = `slot ${type}`;
        return slot;
    }

    function createChip(text, type, pairValue, container) {
        const chip = document.createElement('div');
        chip.className = `char-chip char-${type}`;
        chip.textContent = text;
        chip.dataset.value = text;
        chip.dataset.pair = pairValue; // ãƒšã‚¢ã¨ãªã‚‹æ–‡å­—
        chip.dataset.type = type;      // hira or kata

        // ãƒ—ãƒ¼ãƒ«å†…ã®ã‚¹ãƒ­ãƒƒãƒˆã«å…¥ã‚Œã¦é…ç½®ï¼ˆãƒ—ãƒ¼ãƒ«ã«æˆ»ã™ã¨ãç”¨ï¼‰
        const poolSlot = createSlot('pool-slot');
        poolSlot.style.border = 'none'; // ãƒ—ãƒ¼ãƒ«å†…ã¯è¦‹ãˆãªã„æ 
        poolSlot.style.background = 'transparent';
        poolSlot.appendChild(chip);
        container.appendChild(poolSlot);

        // ãƒ‰ãƒ©ãƒƒã‚°ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
        setupDrag(chip);
    }

    // --- ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—åˆ¶å¾¡ (ã‚¹ãƒãƒ›å¯¾å¿œ) ---
    let draggedItem = null;
    let touchOffsetX = 0;
    let touchOffsetY = 0;
    let ghost = null;
    let originSlot = null; // å…ƒã„ãŸå ´æ‰€

    function setupDrag(el) {
        // ãƒã‚¦ã‚¹
        el.addEventListener('mousedown', startDrag);
        // ã‚¿ãƒƒãƒ
        el.addEventListener('touchstart', startDrag, {passive: false});
    }

    function startDrag(e) {
        e.preventDefault(); // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢
        draggedItem = e.target;
        originSlot = draggedItem.parentElement;

        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        const rect = draggedItem.getBoundingClientRect();
        touchOffsetX = clientX - rect.left;
        touchOffsetY = clientY - rect.top;

        // ã‚´ãƒ¼ã‚¹ãƒˆä½œæˆ
        ghost = draggedItem.cloneNode(true);
        ghost.className += ' ghost';
        ghost.style.width = rect.width + 'px';
        ghost.style.height = rect.height + 'px';
        document.body.appendChild(ghost);
        moveGhost(clientX, clientY);

        // å…ƒã®è¦ç´ ã¯è–„ãã™ã‚‹ã‹æ¶ˆã™ï¼ˆã“ã“ã§ã¯è¦–è¦šçš„ã«æ®‹ã™ãŒã€æ“ä½œå¯¾è±¡ã¯Ghostï¼‰
        draggedItem.style.opacity = '0.3';

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
        document.addEventListener('mousemove', onMove);
        document.addEventListener('mouseup', onEnd);
        document.addEventListener('touchmove', onMove, {passive: false});
        document.addEventListener('touchend', onEnd);
    }

    function onMove(e) {
        e.preventDefault();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        moveGhost(clientX, clientY);

        // ãƒ‰ãƒ­ãƒƒãƒ—å…ˆã®ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆç°¡æ˜“ç‰ˆï¼‰
        const target = getTargetSlot(clientX, clientY);
        document.querySelectorAll('.slot').forEach(s => s.classList.remove('drag-over'));
        if (target && isValidDrop(target, draggedItem)) {
            target.classList.add('drag-over');
        }
    }

    function moveGhost(x, y) {
        if(ghost) {
            ghost.style.left = (x - touchOffsetX) + 'px';
            ghost.style.top = (y - touchOffsetY) + 'px';
        }
    }

    function onEnd(e) {
        // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        document.removeEventListener('mousemove', onMove);
        document.removeEventListener('mouseup', onEnd);
        document.removeEventListener('touchmove', onMove);
        document.removeEventListener('touchend', onEnd);
        
        if(ghost) ghost.remove();
        ghost = null;
        
        draggedItem.style.opacity = '1';

        // ãƒ‰ãƒ­ãƒƒãƒ—åˆ¤å®š
        const clientX = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
        const clientY = e.changedTouches ? e.changedTouches[0].clientY : e.clientY;
        const target = getTargetSlot(clientX, clientY);

        document.querySelectorAll('.slot').forEach(s => s.classList.remove('drag-over'));

        if (target && isValidDrop(target, draggedItem)) {
            // æ—¢ã«ä½•ã‹å…¥ã£ã¦ã„ãŸã‚‰å…¥ã‚Œæ›¿ãˆã‚‹ï¼ˆãƒ—ãƒ¼ãƒ«ã«æˆ»ã™ï¼‰
            if (target.children.length > 0) {
                const existing = target.children[0];
                // å…ƒã®ãƒ—ãƒ¼ãƒ«ã«æˆ»ã™ï¼ˆãƒ—ãƒ¼ãƒ«å†…ã®ç©ºãã‚¹ãƒ­ãƒƒãƒˆã‚’æ¢ã™ã®ã¯è¤‡é›‘ãªã®ã§ã€å…ƒã®å ´æ‰€ã«æˆ»ã™ï¼‰
                // ç°¡æ˜“çš„ã«ã€å…¥ã‚Œæ›¿ãˆå…ƒãŒãƒ—ãƒ¼ãƒ«ãªã‚‰äº¤æ›ã€åˆ¥ã®è¡Œãªã‚‰äº¤æ›
                originSlot.appendChild(existing);
            }
            target.appendChild(draggedItem);
            playClickSound();
        } else {
            // ç„¡åŠ¹ãªå ´æ‰€ãªã‚‰ä½•ã‚‚ã—ãªã„ï¼ˆå…ƒã®å ´æ‰€ã«æˆ»ã‚‹ï¼‰
        }
        draggedItem = null;
    }

    // åº§æ¨™ã‹ã‚‰ã‚¹ãƒ­ãƒƒãƒˆã‚’å–å¾—
    function getTargetSlot(x, y) {
        const el = document.elementFromPoint(x, y);
        if (!el) return null;
        return el.closest('.slot');
    }

    // ãƒ‰ãƒ­ãƒƒãƒ—å¯èƒ½ã‹åˆ¤å®š
    function isValidDrop(slot, item) {
        // ãƒ—ãƒ¼ãƒ«ã«æˆ»ã™ã®ã¯å¸¸ã«OK
        if (slot.classList.contains('pool-slot')) return true;

        // ã²ã‚‰ãŒãªã‚¹ãƒ­ãƒƒãƒˆã«ã¯ã²ã‚‰ãŒãªã®ã¿
        if (slot.classList.contains('hira-slot') && item.dataset.type === 'hira') return true;
        
        // ã‚«ã‚¿ã‚«ãƒŠã‚¹ãƒ­ãƒƒãƒˆã«ã¯ã‚«ã‚¿ã‚«ãƒŠã®ã¿
        if (slot.classList.contains('kata-slot') && item.dataset.type === 'kata') return true;

        return false;
    }

    function playClickSound() {
        // è»½ã„ã‚¯ãƒªãƒƒã‚¯éŸ³ï¼ˆä»»æ„ï¼‰
    }

    // --- åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ ---
    window.checkAnswer = () => {
        const rows = document.querySelectorAll('.pair-row');
        let allCorrect = true;
        let isFull = true;

        // å…¨ã¦åŸ‹ã¾ã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        rows.forEach(row => {
            const hSlot = row.querySelector('.hira-slot');
            const kSlot = row.querySelector('.kata-slot');
            if (hSlot.children.length === 0 || kSlot.children.length === 0) {
                isFull = false;
            }
        });

        if (!isFull) {
            // ã¾ã åŸ‹ã¾ã£ã¦ãªã„å ´åˆã‚‚ä¸æ­£è§£éŸ³ã‚’é³´ã‚‰ã™ã‹ã€ä½•ã‚‚ã—ãªã„ã‹
            // æŒ‡ç¤ºã¯ã€Œå…¨ã¦æ­£è§£ã™ã‚‹ã¾ã§æ¬¡ã«é€²ã‚ãªã„ã€
            sndIncorrect.currentTime = 0;
            sndIncorrect.play();
            return; 
        }

        // æ­£èª¤åˆ¤å®š
        rows.forEach(row => {
            const hItem = row.querySelector('.hira-slot').children[0];
            const kItem = row.querySelector('.kata-slot').children[0];
            
            const hVal = hItem.dataset.value;
            const kVal = kItem.dataset.value;
            
            // dataset.pair ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ã€ã‚ã‚‹ã„ã¯æ–‡å­—ã‚³ãƒ¼ãƒ‰ãªã©ã§åˆ¤å®š
            // ã“ã“ã§ã¯ levels ãƒ‡ãƒ¼ã‚¿å®šç¾©å†…ã®ãƒšã‚¢æƒ…å ±ã¨çªåˆã™ã‚‹
            // ç°¡æ˜“çš„ã« item.dataset.pair ãŒç›¸æ‰‹ã®æ–‡å­—ã‚’æŒã£ã¦ã„ã‚‹
            if (hItem.dataset.pair !== kVal) {
                allCorrect = false;
            }
        });

        if (allCorrect) {
            sndCorrect.currentTime = 0;
            sndCorrect.play();
            modal.style.display = 'flex'; // æ¬¡ã¸ãƒœã‚¿ãƒ³è¡¨ç¤º
        } else {
            sndIncorrect.currentTime = 0;
            sndIncorrect.play();
            // ã©ã“ãŒé–“é•ã£ã¦ã„ã‚‹ã‹ã¯è¡¨ç¤ºã—ãªã„
        }
    };

    window.nextLevel = () => {
        currentLevelIndex++;
        loadLevel(currentLevelIndex);
    };

    // é–‹å§‹
    window.onload = initGame;

</script>

</body>
</html>