<script>
    // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
    const i18nData = {
        ja: { 
            main_title: "Fun Learning Japanese", btn_login: "ãƒ­ã‚°ã‚¤ãƒ³", btn_signup: "ç™»éŒ²", btn_guest: "ã‚²ã‚¹ãƒˆ", 
            group_kiso: "åŸºç¤ãƒ»å˜èª", group_game: "ã‚²ãƒ¼ãƒ ",
            btn_kiso: "ã²ã‚‰ãŒãªåŸºç¤", btn_hiragana_video: "å‹•ç”»ç·´ç¿’", btn_keiyoshi_list: "å½¢å®¹è©ãƒªã‚¹ãƒˆ", btn_kanji_list: "æ¼¢å­—ãƒªã‚¹ãƒˆ",
            // â˜…ä¿®æ­£: æ–°ã—ã„8ã‚«ãƒ†ã‚´ãƒªã®ã‚­ãƒ¼å®šç¾©
            cat_hiragana: "ã²ã‚‰ãŒãª", cat_katakana: "ã‚«ã‚¿ã‚«ãƒŠ", cat_shiritori: "ã—ã‚Šã¨ã‚Š", cat_word_other: "ã“ã¨ã°",
            cat_clock: "ã¨ã‘ã„", cat_kanji_game: "ã‹ã‚“ã˜", cat_keiyoshi_game: "ã‘ã„ã‚ˆã†ã—", cat_sentence: "ã¶ã‚“ã—ã‚‡ã†"
        },
        en: { 
            main_title: "Fun Learning Japanese", btn_login: "Login", btn_signup: "Sign Up", btn_guest: "Guest", 
            group_kiso: "Basics", group_game: "Games",
            btn_kiso: "Kana Basics", btn_hiragana_video: "Video Practice", btn_keiyoshi_list: "Adj List", btn_kanji_list: "Kanji List",
            // â˜…ä¿®æ­£: æ–°ã—ã„8ã‚«ãƒ†ã‚´ãƒªã®ã‚­ãƒ¼å®šç¾© (ç°¡ç•¥åŒ–)
            cat_hiragana: "Hiragana", cat_katakana: "Katakana", cat_shiritori: "Shiritori", cat_word_other: "Words",
            cat_clock: "Clock", cat_kanji_game: "Kanji", cat_keiyoshi_game: "Adjectives", cat_sentence: "Sentence"
        }
    };

    // â˜… å…¨ã‚²ãƒ¼ãƒ ã‚’8ã‚«ãƒ†ã‚´ãƒªã«åˆ†å‰²ã—ã¦å†å®šç¾©
    const gameStructure = [
        // 1. ã²ã‚‰ãŒãª (3ã‚²ãƒ¼ãƒ ) -> éš•çŸ³ã‚¯ã‚¤ã‚ºã‚’è¿½åŠ ã—ã¦4ã‚²ãƒ¼ãƒ ã«
        {
            id: "hiragana",
            icon: "fa-solid fa-h", 
            color: "#ff6f61", // èµ¤ç³»
            titleKey: "cat_hiragana",
            games: [
                { url: "hiragana_v2.html", title: "ã²ã‚‰ãŒãªå˜èª", icon: "fa-solid fa-shapes" },
                { url: "hiragana2_v2.html", title: "ä¸¦ã³æ›¿ãˆ", icon: "fa-solid fa-sort-alpha-down" },
                { url: "hiragana_match_v2.html", title: "ã²ã‚‰ãŒãªãƒãƒƒãƒ", icon: "fa-solid fa-hand-pointer" },
                { url: "meteor_quiz.html", title: "éš•çŸ³ã‚¯ã‚¤ã‚º", icon: "fa-solid fa-meteor" } // â˜…ã“ã“ã«è¿½åŠ 
            ]
        },
        // 2. ã‚«ã‚¿ã‚«ãƒŠ (1ã‚²ãƒ¼ãƒ )
        {
            id: "katakana",
            icon: "fa-solid fa-k", 
            color: "#ffa726", // ã‚ªãƒ¬ãƒ³ã‚¸ç³»
            titleKey: "cat_katakana",
            games: [
                { url: "katakana_match_v2.html", title: "ã‚«ã‚¿ã‚«ãƒŠãƒãƒƒãƒ", icon: "fa-solid fa-hand-pointer" }
            ]
        },
        // 3. ã—ã‚Šã¨ã‚Š (2ã‚²ãƒ¼ãƒ )
        {
            id: "shiritori",
            icon: "fa-solid fa-comments", 
            color: "#f0ad4e", // é»„è‰²ç³»
            titleKey: "cat_shiritori",
            games: [
                { url: "shiritori_v2.html", title: "ã—ã‚Šã¨ã‚Š1", icon: "fa-solid fa-comment-dots" },
                { url: "shiritori2_v2.html", title: "ã—ã‚Šã¨ã‚Š2", icon: "fa-regular fa-comments" }
            ]
        },
        // 4. ã“ã¨ã° (ã—ã‚Šã¨ã‚Šä»¥å¤– 3ã‚²ãƒ¼ãƒ )
        {
            id: "word_other",
            icon: "fa-solid fa-microphone", 
            color: "#00bcd4", // ã‚·ã‚¢ãƒ³ç³»
            titleKey: "cat_word_other",
            games: [
                { url: "verb_v2.html", title: "ã©ã†ã—ã‚²ãƒ¼ãƒ ", icon: "fa-solid fa-person-running" },
                { url: "treasure_Hunt_v2.html", title: "å®æ¢ã—", icon: "fa-solid fa-gem" },
                { url: "aisatsu_quiz_v2.html", title: "ã‚ã„ã•ã¤", icon: "fa-solid fa-hand-spock" },
            ]
        },
        // 5. ã¨ã‘ã„ (2ã‚²ãƒ¼ãƒ )
        {
            id: "clock",
            icon: "fa-solid fa-clock", 
            color: "#42a5f5", // é’ç³»
            titleKey: "cat_clock",
            games: [
                { url: "clock.html", title: "ã¨ã‘ã„1", icon: "fa-regular fa-clock" },
                { url: "clock2.html", title: "ã¨ã‘ã„2", icon: "fa-solid fa-stopwatch" }
            ]
        },
        // 6. ã‹ã‚“ã˜ (2ã‚²ãƒ¼ãƒ  -> éš•çŸ³ã‚¯ã‚¤ã‚ºã‚’å‰Šé™¤ã—ã¦1ã‚²ãƒ¼ãƒ ã«)
        {
            id: "kanji_game",
            icon: "fa-solid fa-pen-fancy", 
            color: "#66bb6a", // ç·‘ç³»
            titleKey: "cat_kanji_game",
            games: [
                { url: "kanji_quiz.html", title: "ã‹ã‚“ã˜ã‚¯ã‚¤ã‚º", icon: "fa-solid fa-scroll" }
                // â˜…ã“ã“ã‹ã‚‰å‰Šé™¤
            ]
        },
        // 7. ã‘ã„ã‚ˆã†ã— (2ã‚²ãƒ¼ãƒ )
        {
            id: "keiyoshi_game",
            icon: "fa-solid fa-star-half-stroke", 
            color: "#ab47bc", // ç´«ç³»
            titleKey: "cat_keiyoshi_game",
            games: [
                { url: "keiyoshi.html", title: "ã‘ã„ã‚ˆã†ã—1", icon: "fa-solid fa-star-half-stroke" },
                { url: "adjective_quiz.html", title: "ã‘ã„ã‚ˆã†ã—2", icon: "fa-regular fa-star" },
            ]
        },
        // 8. ã¶ã‚“ã—ã‚‡ã† (1ã‚²ãƒ¼ãƒ )
        {
            id: "sentence",
            icon: "fa-solid fa-layer-group", 
            color: "#546e7a", // ã‚°ãƒ¬ãƒ¼ç³»
            titleKey: "cat_sentence",
            games: [
                { url: "sentence_puzzle.html", title: "ã¶ã‚“ã¥ãã‚Š", icon: "fa-solid fa-layer-group" }
            ]
        }
    ];

    // --- ã‚²ãƒ¼ãƒ ã‚°ãƒªãƒƒãƒ‰åˆ¶å¾¡ ---
    const gameGrid = document.getElementById('game-grid');
    const backBtn = document.getElementById('game-back-btn');
    let currentLang = 'ja';

    // 1. ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
    function renderGameCategories() {
        gameGrid.innerHTML = '';
        backBtn.style.display = 'none';
        document.getElementById('game-section-title').textContent = i18nData[currentLang].group_game;

        gameStructure.forEach(cat => {
            const div = document.createElement('div');
            div.className = 'game-card category-card';
            div.onclick = () => renderGameList(cat);
            
            const title = i18nData[currentLang][cat.titleKey] || cat.titleKey;
            
            div.innerHTML = `
                <i class="${cat.icon} card-icon" style="color:${cat.color}"></i>
                <span class="card-title">${title}</span>
                <span style="font-size:0.8em; color:#666; margin-top:5px;">${cat.games.length} Games</span>
            `;
            gameGrid.appendChild(div);
        });
        
        gameGrid.classList.remove('fade-in');
        void gameGrid.offsetWidth;
        gameGrid.classList.add('fade-in');
    }

    // 2. ã‚«ãƒ†ã‚´ãƒªå†…ã®ã‚²ãƒ¼ãƒ ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
    function renderGameList(category) {
        gameGrid.innerHTML = '';
        backBtn.style.display = 'block';
        document.getElementById('game-section-title').textContent = i18nData[currentLang][category.titleKey];

        category.games.forEach(game => {
            const a = document.createElement('a');
            a.href = game.url;
            a.className = 'game-card';
            a.innerHTML = `
                <i class="${game.icon} card-icon" style="color:${category.color}"></i>
                <span class="card-title">${game.title}</span>
            `;
            gameGrid.appendChild(a);
        });

        gameGrid.classList.remove('fade-in');
        void gameGrid.offsetWidth;
        gameGrid.classList.add('fade-in');
    }


    // --- èªè¨¼ãƒ»UIãƒ­ã‚¸ãƒƒã‚¯ (å‰å›ã¨åŒã˜) ---
    const USER_KEY = 'user_accounts';
    const SESS_KEY = 'current_user';
    
    function updateUI() {
        const user = sessionStorage.getItem(SESS_KEY);
        if (user) {
            document.getElementById('guest-welcome').classList.add('hidden');
            document.getElementById('user-dashboard').classList.remove('hidden');
            let users = JSON.parse(localStorage.getItem(USER_KEY) || '{}');
            let userData = users[user] || { points: 0, streak: 0 };
            if(user === 'ã‚²ã‚¹ãƒˆ') userData = { points: 0, streak: 0 };
            document.getElementById('user-name').textContent = user;
            document.getElementById('streak-val').textContent = userData.streak;
            document.getElementById('point-val').textContent = userData.points;
            const level = Math.floor(userData.points / 100) + 1;
            document.getElementById('user-lvl').textContent = level;
            document.getElementById('level-fill').style.width = `${(userData.points % 100)}%`;
        } else {
            document.getElementById('guest-welcome').classList.remove('hidden');
            document.getElementById('user-dashboard').classList.add('hidden');
        }
    }

    document.getElementById('login-btn').onclick = () => openAuthModal('login');
    document.getElementById('signup-btn').onclick = () => openAuthModal('signup');
    document.getElementById('guest-btn').onclick = () => { sessionStorage.setItem(SESS_KEY, 'ã‚²ã‚¹ãƒˆ'); updateUI(); };
    document.getElementById('logout-btn').onclick = () => { sessionStorage.removeItem(SESS_KEY); updateUI(); };

    const modal = document.getElementById('auth-modal');
    let authMode = 'login';
    function openAuthModal(mode) {
        authMode = mode;
        modal.style.display = 'flex';
        document.getElementById('modal-title').textContent = mode === 'login' ? 'ãƒ­ã‚°ã‚¤ãƒ³' : 'æ–°è¦ç™»éŒ²';
        document.getElementById('modal-msg').textContent = '';
    }
    document.getElementById('modal-close').onclick = () => modal.style.display = 'none';
    document.getElementById('modal-submit').onclick = () => {
        const name = document.getElementById('auth-name').value;
        const pass = document.getElementById('auth-pass').value;
        const msg = document.getElementById('modal-msg');
        let users = JSON.parse(localStorage.getItem(USER_KEY) || '{}');
        if (!name || !pass) { msg.textContent = 'å…¥åŠ›ã—ã¦ãã ã•ã„'; return; }
        if (authMode === 'signup') {
            if (users[name]) { msg.textContent = 'ãã®åå‰ã¯ä½¿ã‚ã‚Œã¦ã„ã¾ã™'; return; }
            users[name] = { password: pass, points: 0, streak: 1 };
            localStorage.setItem(USER_KEY, JSON.stringify(users));
            sessionStorage.setItem(SESS_KEY, name);
        } else {
            if (!users[name] || users[name].password !== pass) { msg.textContent = 'åå‰ã‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™'; return; }
            sessionStorage.setItem(SESS_KEY, name);
        }
        modal.style.display = 'none';
        updateUI();
    };

    window.setLanguage = (lang) => {
        currentLang = lang;
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.dataset.i18n;
            if(i18nData[lang][key]) el.textContent = i18nData[lang][key];
        });
        document.getElementById('lang-ja').classList.toggle('active', lang === 'ja');
        document.getElementById('lang-en').classList.toggle('active', lang === 'en');
        
        if(backBtn.style.display === 'none') {
            renderGameCategories();
        } else {
            // ã‚µãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã„ã¦ã„ã‚‹å ´åˆã¯ã‚¿ã‚¤ãƒˆãƒ«ã ã‘æ›´æ–°ã—ãŸã„ãŒã€ç°¡å˜ã®ãŸã‚ã‚«ãƒ†ã‚´ãƒªã«æˆ»ã™
            renderGameCategories(); 
        }
    };

    window.toggleRanking = () => {
        const rModal = document.getElementById('ranking-modal');
        const list = document.getElementById('ranking-list');
        rModal.style.display = 'flex';
        list.innerHTML = '';
        let users = JSON.parse(localStorage.getItem(USER_KEY) || '{}');
        let sorted = Object.keys(users).map(k => ({name: k, pt: users[k].points || 0})).sort((a,b) => b.pt - a.pt).slice(0,5);
        sorted.forEach((u, i) => {
            const icon = i===0 ? 'ğŸ¥‡' : i===1 ? 'ğŸ¥ˆ' : i===2 ? 'ğŸ¥‰' : `${i+1}.`;
            list.innerHTML += `<li style="padding:10px; border-bottom:1px dashed #ccc; font-weight:bold;">${icon} ${u.name} <span style="float:right; color:#f0ad4e;">${u.pt}pt</span></li>`;
        });
    };

    // åˆæœŸåŒ–
    updateUI();
    renderGameCategories();
</script>
</body>
</html>
```http://googleusercontent.com/image_generation_content/0